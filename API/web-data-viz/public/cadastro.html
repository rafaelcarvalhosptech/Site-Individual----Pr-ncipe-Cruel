<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Príncipe Cruel | Cadastro</title>

  <script src="./js/sessao.js"></script>

  <link rel="stylesheet" href="./css/estilo.css" />
  <link rel="icon" href="./assets/icon/favicon2.ico" />
  <link rel="preconnect" href="https://fonts.gstatic.com" />
</head>

<body>
  <!--header inicio-->
  <div class="header2">
    <div class="container2">
      <h1 class="titulo2">Principe Cruel</h1>
      <ul class="navbar2">
        <li>
          <a href="index.html">Início</a>
        </li>
        <li>
          <a href="login.html">Login</a>
        </li>
        <li class="agora2">
          <a href="cadastro.html">Cadastro</a>
        </li>
      </ul>
    </div>
  </div>
  <!--header fim-->

  <div class="login">
    <div class="alerta_erro">
      <div class="card_erro" id="cardErro">
        <span id="mensagem_erro"></span>
      </div>
    </div>
    <div class="container">
      <div class="card card-cadastro">
        <h2>Bem-vindo!</h2>
        <div class="formulario">
          <div class="campo">
            <span>Nome:</span>
            <input id="nome_input" type="text" placeholder="Seu nome" />
          </div>
          <div class="campo">
            <span>E-mail:</span>
            <input id="email_input" type="text" placeholder="Seu email" />
          </div>
          <div class="campo">
            <span>Senha:</span>
            <input id="senha_input" type="password" placeholder="******" />
          </div>
          <div class="campo">
            <span>Confirmação da Senha:</span>
            <input id="confirmacao_senha_input" type="password" placeholder="******" />
          </div>
          <button class="botao" onclick="cadastrar()">Cadastrar</button>
        </div>
        <div id="div_aguardar" class="loading-div">
          <img src="./assets/circle-loading.gif" id="loading-gif" />
        </div>

        <div id="div_erros_login"></div>
      </div>
    </div>
  </div>

  

  <!--footer inicio-->
 <div class="footer">
    <div class="footer-container">
      <div class="footer-logo">
        <h2>Príncipe Cruel</h2>
        <p>Imersão do livro Príncipe Cruel</p>
      </div>

      <div class="footer-links">
        <a href="index.html">Início</a>
        <a href="cadastro.html">Cadastro</a>
        <a href="login.html">Login</a>
      </div>
    </div>
  </div>
  <!--footer fim-->

<!-- <div id="quiz" class="header-quiz">

        <div id="container_quiz" class="container-quiz">
          <select class="select_time" onclick="mostrar()" id="select_time">
            <option selected disabled value="">Selecione seu time</option>
            <option value="1">Corinthians</option>
            <option value="2">Palmeiras</option>
            <option value="3">São paulo</option>
            <option value="4">Santos</option>
            <option value="5">Vasco</option>
            <option value="6">Flamengo</option>
            <option value="7">Fluminense</option>
            <option value="8">Cruzeiro</option>
            <option value="9">Grêmio</option>
            <option value="10">Internacional</option>

          </select>
          <div style="display: none;" id="div_corinthians">
            <p>Fundado em 1910, o Corinthians é um dos clubes mais populares e vitoriosos do Brasil, com uma vasta
              torcida.
              Tem grandes conquistas, como a Copa Libertadores de 2012 e o Mundial de Clubes da FIFA em 2000 e 2012. O
              time
              tem uma rivalidade histórica com o Palmeiras, Santos e São Paulo.</p>
            <img src="css/imagens/escudo-Corinthians.webp" alt="">
            <button class="div-times" onclick="selecionar()">Selecionar time</button>
          </div>
          <div style="display: none;" id="div_palmeiras">
            <p>Fundado em 1914, o Palmeiras é um dos clubes mais bem-sucedidos do Brasil, com um grande número de
              títulos,
              incluindo a Copa Libertadores (2020, 2022). A rivalidade com o Corinthians é intensa, sendo um dos maiores
              clássicos do futebol paulista.</p>
            <img src="css/imagens/palmeiras.png" alt="">

            <button class="div-times" onclick="selecionar()">Selecionar time</button>
          </div>
          <div style="display: none;" id="div_saopaulo">
            <p>Fundado em 1930, o São Paulo é um dos clubes mais prestigiados do Brasil, com vários títulos nacionais e
              internacionais, incluindo a Copa Libertadores e o Mundial de Clubes. Seu estádio, o Morumbi, é um dos
              maiores
              do país. A rivalidade com Palmeiras e Corinthians é histórica.</p>
            <img src="css/imagens/saopaulo.png" alt="">

            <button class="div-times" onclick="selecionar()">Selecionar time</button>
          </div>
          <div style="display: none;" id="div_santos">
            <p>Fundado em 1912, o Santos é conhecido mundialmente por sua relação com Pelé, considerado o maior jogador
              de
              futebol de todos os tempos. O time possui uma das maiores torcidas do Brasil e uma rica história de
              títulos
              nacionais e internacionais.</p>
            <img src="css/imagens/santos.png" alt="">

            <button class="div-times" onclick="selecionar()">Selecionar time</button>
          </div>
          <div style="display: none;" id="div_vasco">
            <p>Fundado em 1898, o Vasco é um dos clubes de maior tradição do Brasil, com uma enorme torcida e várias
              conquistas nacionais, como o Campeonato Brasileiro. A rivalidade com Flamengo e Fluminense é intensa,
              especialmente no Rio de Janeiro.</p>
            <img src="css/imagens/vasco.png" alt="">

            <button class="div-times" onclick="selecionar()">Selecionar time</button>
          </div>
          <div style="display: none;" id="div_flamengo">
            <p>Fundado em 1895, o Flamengo é um dos clubes mais populares e vitoriosos do Brasil, com uma base de fãs
              espalhada por todo o país. O time tem uma rivalidade histórica com o Fluminense, Vasco e Botafogo, e já
              conquistou inúmeros títulos, incluindo a Copa Libertadores e o Mundial de Clubes.</p>
            <img src="css/imagens/flamengo.png" alt="">

            <button class="div-times" onclick="selecionar()">Selecionar time</button>
          </div>
          <div style="display: none;" id="div_fluminense">
            <p>Fundado em 1902, o Fluminense é um dos clubes mais tradicionais do Brasil, com uma grande história no
              futebol. O time tem uma grande rivalidade com Flamengo e Vasco. O Fluminense é conhecido por seu estilo de
              jogo técnico e por suas grandes gerações de jogadores.</p>
            <img src="css/imagens/fluminense.png" alt="">

            <button class="div-times" onclick="selecionar()">Selecionar time</button>
          </div>
          <div style="display: none;" id="div_cruzeiro">
            <p>Fundado em 1921, o Cruzeiro é um dos clubes mais vitoriosos de Minas Gerais e do Brasil. Com várias
              conquistas nacionais e internacionais, o Cruzeiro tem uma grande base de torcedores e rivaliza com times
              como
              Atlético-MG e Flamengo.</p>
            <img src="css/imagens/cruzeiro.png" alt="">

            <button class="div-times" onclick="selecionar()">Selecionar time</button>
          </div>
          <div style="display: none;" id="div_gremio">
            <p>Fundado em 1903, o Grêmio é um dos clubes mais tradicionais do Brasil, com uma forte base de torcedores
              no
              sul do país. O time tem uma grande história de títulos nacionais e internacionais, incluindo a Copa
              Libertadores.</p>
            <img src="css/imagens/gremio.webp" alt="">

            <button class="div-times" onclick="selecionar()">Selecionar time</button>
          </div>
          <div style="display: none;" id="div_internacional">
            <p>Fundado em 1909, o Internacional, também conhecido como Inter, é um dos maiores clubes do sul do Brasil.
              Com
              várias conquistas nacionais e internacionais, incluindo a Copa Libertadores e o Mundial de Clubes, o time
              tem
              uma rivalidade forte com o Grêmio no clássico "Grenal".</p>
            <img src="css/imagens/internacional.png" alt="">

            <button class="div-times" onclick="selecionar()">Selecionar time</button>
          </div>
          <div class="perguntas-quiz" id="perguntas1_div">
            <span>Vai ao estádio do seu time uma vez ao mês?</span>
            <select class="div-times" onchange="proxima()" id="select_pergunta1">
              <option selected disabled value="">Selecione uma opção</option>
              <option value="0">Não</option>
              <option value="20">Sim</option>

            </select>

          </div>

          <div class="perguntas-quiz" id="perguntas2_div">
            <span>Segue jogadores ou clubes nas redes sociais?</span>
            <select class="div-times" onchange="proxima2()" id="select_pergunta2">
              <option selected disabled value="">Selecione uma opção</option>
              <option value="0">Não</option>
              <option value="20">Sim</option>
            </select>

          </div>

          <div class="perguntas-quiz" id="perguntas3_div">
            <span>Assiste aos jogos do seu time toda semana?</span>
            <select class="div-times" onchange="proxima3()" id="select_pergunta3">
              <option selected disabled value="">Selecione uma opção</option>
              <option value="0">Não</option>
              <option value="20">Sim</option>
            </select>

          </div>

          <div class="perguntas-quiz" id="perguntas4_div">
            <span>Já fez parte de alguma torcida organizada?</span>
            <select class="div-times" onchange="proxima4()" id="select_pergunta4">
              <option selected disabled value="">Selecione uma opção</option>
              <option value="0">Não</option>
              <option value="20">Sim</option>
            </select>

          </div>

          <div class="perguntas-quiz" id="perguntas5_div">
            <span>Já participou de algum programa de sócio-torcedor?</span>
            <select class="div-times" id="select_pergunta5">
              <option selected disabled value="">Selecione uma opção</option>
              <option value="0">Não</option>
              <option value="20">Sim</option>
            </select>
            <button id="button_cadastro" class="botao" onclick="cadastrar()">Cadastrar</button>

          </div>
        </div>

      </div> -->



</body>

</html>

<script>

  // Array para armazenar empresas cadastradas para validação de código de ativação 
  let listaEmpresasCadastradas = [];

  function cadastrar() {

  var nomeVar = nome_input.value;
  var emailVar = email_input.value;
  var senhaVar = senha_input.value;
  var confirmacaoVar = confirmacao_senha_input.value;
  // var personagemVar = personagem_select.value; // select do personagem

  if (
    nomeVar == "" ||
    emailVar == "" ||
    senhaVar == "" ||
    confirmacaoVar == "" 
    // personagemVar == ""
  ) {
    cardErro.style.display = "block";
    mensagem_erro.innerHTML = "(Preencha todos os campos!)";
    finalizarAguardar();
    return false;
  } else {
    setInterval(sumirMensagem, 5000);
  }

  if (senhaVar != confirmacaoVar) {
    cardErro.style.display = "block";
    mensagem_erro.innerHTML = "(As senhas não coincidem)";
    finalizarAguardar();
    return false;
  }

  fetch("/usuarios/cadastrar", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      nomeServer: nomeVar,
      emailServer: emailVar,
      senhaServer: senhaVar,
      // idPersonagemServer: personagemVar
    }),
  })
    .then(function (resposta) {

      if (resposta.ok) {
        cardErro.style.display = "block";
        mensagem_erro.innerHTML =
          "Cadastro realizado com sucesso! Redirecionando...";

        setTimeout(() => {
          window.location = "login.html";
        }, 2000);

        limparFormulario();
        finalizarAguardar();
      } else {
        resposta.text().then(texto => {
          cardErro.style.display = "block";
          mensagem_erro.innerHTML = texto;
          finalizarAguardar();
        });
      }
    })
    .catch(function (erro) {
      console.log("#ERRO: ", erro);
      finalizarAguardar();
    });

  return false;
}

//   function listar() {
//     fetch("/usuarios/cadastrar", {
//   method: "POST",
//   headers: { "Content-Type": "application/json" },
//   body: JSON.stringify({
//     nomeServer: nomeVar,
//     emailServer: emailVar,
//     senhaServer: senhaVar,
//     timeServer: Number(timeEscolhidoVar), 
//     p1: Number(select_pergunta1.value),
//     p2: Number(select_pergunta2.value),
//     p3: Number(select_pergunta3.value),
//     p4: Number(select_pergunta4.value),
//     p5: Number(select_pergunta5.value),
//     nivel: Number(pontuacaoFinal) 
//   })
// })
// .then(async (res) => {
//   const ct = res.headers.get("content-type") || "";
//   const body = ct.includes("application/json") ? await res.json() : await res.text();

//   if (res.ok) {
//     mensagem_erro.innerHTML = "Cadastro realizado! Redirecionando...";
//     setTimeout(() => (window.location = "login.html"), 2000);
//   } else {
//     throw new Error(typeof body === "string" ? body : JSON.stringify(body));
//   }
// })
// .catch((err) => {
//   mensagem_erro.innerHTML = err.message || err;
// });


//   if (
//     nomeVar == "" ||
//     emailVar == "" ||
//     senhaVar == "" ||
//     confirmacaoSenhaVar == ""
//   ) {
//     cardErro.innerHTML = `<p style="color: red;">Todos os campos devem ser preenchidos</p>`;
//     return false;
//   }

//   if (!emailVar.includes("@") || !emailVar.includes(".")) {
//     cardErro.innerHTML = `<p style="color: red;">Digite um e-mail válido.</p>`;
//     return false;
//   }

//   if (senhaVar !== confirmacaoSenhaVar) {
//     cardErro.innerHTML = `<p style="color: red;">As senhas não coincidem.</p>`;
//     return false;
//   }
//   }

  function sumirMensagem() {
    cardErro.style.display = "none";
  }
</script>
